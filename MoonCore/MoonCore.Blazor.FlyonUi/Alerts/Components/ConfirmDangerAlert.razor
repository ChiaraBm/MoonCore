@using MoonCore.Blazor.FlyonUi.Components
@using MoonCore.Helpers

@inherits MoonCore.Blazor.FlyonUi.Modals.BaseModal

<div class="flex flex-col gap-6 p-6">
    <div class="flex items-center gap-4">
        <div class="avatar avatar-placeholder max-sm:hidden">
            <div class="border-base-content/20 rounded-box w-13 border-1">
                <i class="icon-circle-alert text-xl"></i>
            </div>
        </div>
        <div class="space-y-1">
            <h3 class="text-base-content text-2xl font-semibold">
                @Title
            </h3>
        </div>
    </div>

    <p class="text-base-content/80 text-base">
        @Formatter.FormatLineBreaks(Text)
    </p>

    <div class="flex items-center">
        <button @onclick="HideAsync" type="button" class="btn btn-secondary grow me-1.5">
            Cancel
        </button>
        <WButton OnClick="ConfirmAsync" CssClasses="btn btn-error grow">
            Confirm
        </WButton>
    </div>
</div>

@code
{
    [Parameter] public string Title { get; set; }
    [Parameter] public string Text { get; set; }
    [Parameter] public Func<Task> ConfirmAction { get; set; }

    private async Task ConfirmAsync()
    {
        try
        {
            await ConfirmAction.Invoke();
            await HideAsync();
        }
        catch (Exception)
        {
            await HideAsync();
            throw;
        }
    }
}