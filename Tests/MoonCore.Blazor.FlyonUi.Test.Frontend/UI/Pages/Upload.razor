@page "/upload"
@using MoonCore.Helpers

<UploadZone MaxSize="ByteConverter.FromGigaBytes(5).Bytes" Callback="HandleAsync"/>

@code
{
    private async Task HandleAsync(string path, Stream stream, Func<int, Task> progress)
    {
        var cache = new byte[ByteConverter.FromMegaBytes(5).Bytes];
        
        while (stream.Position != stream.Length)
        {
            _ = await stream.ReadAsync(cache, 0, cache.Length);

            Console.WriteLine($"D: {stream.Position}/{stream.Length}");
            var percent = (int)Math.Round(stream.Position / (float)stream.Length * 100f);

            await progress.Invoke(percent);
        }
    }
}